<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virtual Bookshelf - 読書ライブラリ</title>
    <meta name="description" content="個人読書コレクション - お気に入りの本を美しく展示">
    
    <!-- Open Graph for social sharing -->
    <meta property="og:title" content="Virtual Bookshelf - 読書ライブラリ">
    <meta property="og:description" content="お気に入りコレクション">
    <meta property="og:type" content="website">
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>📚</text></svg>">
    <link rel="stylesheet" href="css/bookshelf.css">

</head>
<body>
    <header class="header">
        <div class="container">
            <h1 class="header-title">📚 Virtual Bookshelf</h1>
            <p class="header-subtitle">読書ライブラリ</p>
            
            <div class="header-controls">
                <div class="bookshelf-controls">
                    <select id="bookshelf-selector" class="bookshelf-selector">
                        <option value="all">📚 全ての本</option>
                    </select>
                    <button id="manage-bookshelves" class="btn btn-outline">📝 本棚管理</button>
                    <button id="view-static-page" class="btn btn-secondary" style="display: none;">🌐 静的ページ</button>
                </div>
                
                <div class="view-toggle">
                    <button id="view-covers" class="btn btn-primary active">表紙表示</button>
                    <button id="view-list" class="btn btn-secondary">リスト表示</button>
                </div>
                
                <div class="search-box">
                    <input type="text" id="search-input" placeholder="タイトルや著者で検索...">
                </div>
            </div>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <aside class="sidebar">
                <div class="filter-section">
                    <h3>フィルター</h3>
                    
                    <div class="filter-group">
                        <label>星評価フィルター</label>
                        <div class="star-filter-checkboxes">
                            <label class="checkbox-label">
                                <input type="checkbox" id="star-1" value="1" checked>
                                ⭐ 星1
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="star-2" value="2" checked>
                                ⭐⭐ 星2
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="star-3" value="3" checked>
                                ⭐⭐⭐ 星3
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="star-4" value="4" checked>
                                ⭐⭐⭐⭐ 星4
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="star-5" value="5" checked>
                                ⭐⭐⭐⭐⭐ 星5
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="star-0" value="0" checked>
                                ☆ 未評価
                            </label>
                        </div>
                    </div>
                    
                    <div class="filter-group">
                        <label>並び順</label>
                        <select id="sort-order">
                            <option value="custom" selected>カスタム順</option>
                            <option value="acquiredTime">購入日</option>
                            <option value="title">タイトル</option>
                            <option value="authors">著者</option>

                        </select>
                        <button id="sort-direction" class="btn btn-small">↓ 新しい順</button>
                    </div>
                    
                    <div class="filter-group">
                        <label>表示数</label>
                        <select id="books-per-page">
                            <option value="25">25冊</option>
                            <option value="50" selected>50冊</option>
                            <option value="100">100冊</option>
                            <option value="200">200冊</option>
                            <option value="all">全て表示</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>カバーサイズ</label>
                        <select id="cover-size">
                            <option value="small">小 (120×180px)</option>
                            <option value="medium" selected>中 (160×240px)</option>
                            <option value="large">大 (200×300px)</option>
                        </select>
                    </div>
                </div>
                
                <div class="stats-section">
                    <h3>統計情報</h3>
                    <div class="stats">
                        <div class="stat-item">
                            <span class="stat-value" id="total-books">-</span>
                            <span class="stat-label">総蔵書数</span>
                        </div>

                    </div>
                    
                    
                    
                    <div class="library-management">
                        <h3>蔵書管理</h3>
                        <div class="management-buttons">
                            <button id="add-book-manually" class="btn btn-secondary">➕ 手動追加</button>
                            <button id="import-kindle" class="btn btn-secondary">📥 Kindleインポート</button>
                            <button id="export-unified" class="btn btn-secondary">💾 データエクスポート</button>
                            <button id="clear-library" class="btn btn-danger">🗑️ 蔵書をクリア</button>
                        </div>
                    </div>
                </div>
            </aside>

            <section class="bookshelf-container">
                <div class="loading" id="loading">
                    📚 本棚を準備中...
                </div>
                
                <!-- Bookshelf Overview Section -->
                <div class="bookshelves-overview" id="bookshelves-overview" style="display: none;">
                    <h2 class="section-title">📚 本棚一覧</h2>
                    <div class="bookshelf-overview-controls">
                        <button id="toggle-bookshelf-display" class="btn btn-secondary">🖼️ 画像表示切替</button>
                    </div>
                    <div class="bookshelves-grid" id="bookshelves-grid">
                        <!-- Bookshelves overview will be loaded here -->
                    </div>
                </div>
                
                <div class="bookshelf" id="bookshelf">
                    <!-- Books will be dynamically loaded here -->
                </div>
                
                <div class="pagination" id="pagination">
                    <!-- Pagination controls will be added here -->
                </div>
            </section>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>© 2025 からあげ | Powered by Kindle & GitHub Pages</p>
            <p class="affiliate-disclosure">
                ⚠️ <strong>アフィリエイト開示:</strong> このサイトはAmazon.co.jpアソシエイトプログラムに参加しており、
                適格販売により収入を得る場合があります。
            </p>
            <p>
                <a href="https://github.com/karaage0703/karaage-virtual-bookshelf" target="_blank" rel="noopener">
                    GitHub Repository
                </a>
            </p>
        </div>
    </footer>

    <!-- Book detail modal -->
    <div class="modal" id="book-modal">
        <div class="modal-content">
            <button class="modal-close" id="modal-close">×</button>
            <div class="modal-body" id="modal-body">
                <!-- Book details will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Bookshelf Management Modal -->
    <div id="bookshelf-modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" id="bookshelf-modal-close">×</button>
            <div class="modal-header">
                <h2>📚 本棚管理</h2>
                <button id="add-bookshelf" class="btn btn-primary">+ 新しい本棚</button>
            </div>
            <div id="bookshelves-list">
                <!-- Bookshelves will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Bookshelf Form Modal -->
    <div id="bookshelf-form-modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" id="bookshelf-form-modal-close">×</button>
            <div class="modal-header">
                <h2 id="bookshelf-form-title">📚 新しい本棚</h2>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="bookshelf-name">本棚の名前 *</label>
                    <input type="text" id="bookshelf-name" placeholder="本棚の名前を入力してください" required>
                </div>
                <div class="form-group">
                    <label for="bookshelf-emoji">絵文字</label>
                    <input type="text" id="bookshelf-emoji" placeholder="📚" value="📚" maxlength="2">
                </div>
                <div class="form-group">
                    <label for="bookshelf-description">説明</label>
                    <textarea id="bookshelf-description" placeholder="本棚の説明を入力してください（任意）" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="bookshelf-is-public">
                        📤 この本棚を公開する（静的ページ生成可能）
                    </label>
                </div>
                <div class="form-actions" style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: flex-end;">
                    <button id="cancel-bookshelf-form" class="btn btn-secondary">キャンセル</button>
                    <button id="save-bookshelf-form" class="btn btn-primary">保存</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Static Bookshelf Share Modal -->
    <div id="static-share-modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" id="static-share-modal-close">×</button>
            <div class="modal-header">
                <h2>📄 静的ページ生成</h2>
            </div>
            <div class="modal-body">
                <div id="share-generation-form">

                    <div class="form-actions">
                        <button id="generate-static-page" class="btn btn-primary">📄 静的ページを生成</button>
                        <button id="cancel-static-share" class="btn btn-secondary">キャンセル</button>
                    </div>
                </div>
                <div id="share-results" style="display: none;">
                    <div class="share-result-content">
                        <!-- Generation results will be shown here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Book Management Modals -->
    <!-- Kindle Import Modal -->
    <div id="import-modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" id="import-modal-close">×</button>
            <div class="modal-header">
                <h2>📥 Kindleデータインポート</h2>
            </div>
            <div class="modal-body">
                <div class="import-options">
                    <div class="import-option">
                        <h3>ファイルからインポート</h3>
                        <input type="file" id="kindle-file-input" accept=".json" />
                        <button id="import-from-file" class="btn btn-primary">ファイルをインポート</button>
                    </div>

                </div>
                <div id="book-selection" class="book-selection" style="display: none;">
                    <h3>📚 インポートする本を選択</h3>
                    <div class="selection-controls">
                        <div class="filter-options" style="margin-bottom: 1rem;">
                            <label style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="checkbox" id="hide-existing-books" checked>
                                <span>📚 インポート済みの本を非表示にする</span>
                            </label>
                        </div>
                        <button id="select-all-books" class="btn btn-small">全て選択</button>
                        <button id="deselect-all-books" class="btn btn-small">全て解除</button>
                        <span class="selected-count">選択: <span id="selected-count">0</span>冊</span>
                    </div>
                    <div id="book-list" class="book-selection-list">
                        <!-- Book selection checkboxes will be populated here -->
                    </div>
                    <div class="import-actions">
                        <button id="import-selected-books" class="btn btn-primary" disabled>選択した本をインポート</button>
                        <button id="cancel-import" class="btn btn-secondary">キャンセル</button>
                    </div>
                </div>
                <div id="import-results" class="import-results" style="display: none;">
                    <!-- Import results will be shown here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Manual Book Addition Modal -->
    <div id="add-book-modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" id="add-book-modal-close">×</button>
            <div class="modal-header">
                <h2>➕ 手動で本を追加</h2>
            </div>
            <div class="modal-body">
                <div class="add-book-options">
                    <div class="add-option">
                        <h3>本の情報を入力</h3>
                        <div class="form-group">
                            <label for="manual-asin">商品コード（ASIN/ISBN-10）</label>
                            <div class="asin-input-container">
                                <input type="text" id="manual-asin" placeholder="B012345678 または 4798121967" maxlength="10" />
                                <button type="button" id="fetch-book-info" class="btn btn-small btn-secondary">📥 自動取得</button>
                            </div>
                            <div class="asin-status" id="asin-status" style="display: none;"></div>
                        </div>
                        <div class="form-group">
                            <label for="manual-title">タイトル</label>
                            <input type="text" id="manual-title" placeholder="書籍タイトル" />
                        </div>
                        <div class="form-group">
                            <label for="manual-authors">著者</label>
                            <input type="text" id="manual-authors" placeholder="著者名" />
                        </div>

                        <button id="add-manually" class="btn btn-primary">手動追加</button>
                    </div>
                </div>
                <div id="add-book-results" class="add-results" style="display: none;">
                    <!-- Addition results will be shown here -->
                </div>
            </div>
        </div>
    </div>

    <script src="js/book-manager.js"></script>
    <script src="js/highlights.js"></script>
    <script src="js/static-bookshelf-generator.js"></script>
    <script src="js/bookshelf.js"></script>
</body>
</html>